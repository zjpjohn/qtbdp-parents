<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">

<head>
    <meta charset="utf-8" />
    <title>数据商城管理-数据商品管理</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="" name="description" />
    <meta content="" name="author" />
    <meta http-equiv="cache-control" content="no-cache" />
    <link th:href="@{/css/font-awesome.min.css}" rel="stylesheet" type="text/css" />
    <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
    <link href="/css/layout.css" rel="stylesheet" type="text/css" />
    <link href="/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/datatables.min.css">
    <link rel="stylesheet" href="/css/datatables.bootstrap.css">
    <link href="/css/plugins.min.css" rel="stylesheet" type="text/css">
    <link href="/css/darkblue.min.css" rel="stylesheet" type="text/css" id="style_color">

    <!--<link href="/plugins/datatables/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css">-->
    <!--<script src="https://code.jquery.com/jquery-1.12.4.js" type="text/javascript"></script>-->
    <script src="/js/jquery.min.js" type="text/javascript"></script>
</head>
<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">

<!--  页头 -->
<div th:replace="layout/header" /></div>
<!-- 页头结束 -->


<div class="clearfix"> </div>

<div class="page-container">
    <!--侧边栏-->
    <div th:replace="layout/sidebar" /></div>
    <!--侧边栏结束-->

    <!--主体内容-->
    <div class="page-content-wrapper">
        <div class="page-content" style="min-height: 1095px;">
            <!--面包屑-->
            <div class="page-bar">
                <ul class="page-breadcrumb">
                    <li>
                        <span>数据商城管理</span>
                        <i class="fa fa-circle"></i>
                    </li>
                    <li>
                        <a href="#" class="active">数据商品管理</a>
                    </li>
                </ul>
            </div>
            <!--面包屑结束-->
            <div class="portlet light portlet-fit portlet-datatable">
                <div class="portlet-body">
                    <div class="table-container">
                        <!--添加按钮-->
                        <div  style="margin: 20px 0 10px 0">
                            <a href="/setUp" class="btn btn-sm blue btn-outline">添加数据产品</a>
                        </div>
                        <!--表格主体-->
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered table-hover table-checkable no-footer" id="datatable_ajax">
                                <thead>
                                <tr role="row" class="heading">
                                    <th width="5%" class="sorting_disabled" rowspan="1" colspan="1">id</th>
                                    <th width="15%" class="sorting_disabled" rowspan="1" colspan="1">产品类型</th>
                                    <th width="10%" class="sorting_disabled" rowspan="1" colspan="1">类别</th>
                                    <th width="20%" class="sorting_disabled" rowspan="1" colspan="1">名称</th>
                                    <th width="10%" class="sorting_disabled" rowspan="1" colspan="1">发布人</th>
                                    <th width="15%" class="sorting_disabled" rowspan="1" colspan="1">时间</th>
                                    <th width="10%" class="sorting_disabled" rowspan="1" colspan="1"> 操作</th>
                                </tr>
                                </thead>
                                <tbody id="item-info">
                                </tbody>
                            </table>
                        </div>
                        <!--表格主体结束-->
                    </div>
                </div>
            </div>
    </div>
    <!--主体内容结束-->
</div>

<script src="/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/js/bootstrap-hover-dropdown.min.js" type="text/javascript"></script>
<script src="/js/app.min.js" type="text/javascript"></script>
<script src="/js/jquery.blockui.min.js" type="text/javascript"></script>
<script src="/js/jquery.uniform.min.js" type="text/javascript"></script>
<script src="/js/jquery.validate.js" type="text/javascript"></script>
<script src="/js/datatable.js"></script>
<script src="/js/datatables.min.js"></script>
<script src="/js/datatables.bootstrap.js"></script>
<script src="/js/layer.js" type="text/javascript"></script>
<script src="/js/layout.js" type="text/javascript"></script>

<script th:inline="javascript">
   /* $(document).ready(function() {
        $('#datatable_ajax').DataTable( {
            "processing": true,
            "serverSide": true,
            "ajax": {
                "url": "/api/product",
                "type": "GET"
            },
            "columns": [
                { "data": "id" },
                { "data": "dataTypeProps" },
                { "data": "dataType" },
                { "data": "designation" },
                { "data": "userId" },
                { "data": "addTime" },
                { "data": "addTime" }
            ]
        } );
    } );*/


    $(document).ready(function() {
        //初始化表格
        var table = $("#datatable_ajax").dataTable({
//            language:lang,  //提示信息
            autoWidth: false,  //禁用自动调整列宽
            stripeClasses: ["odd", "even"],  //为奇偶行加上样式，兼容不支持CSS伪类的场合
            processing: true,  //隐藏加载提示,自行处理
            serverSide: true,  //启用服务器端分页
            searching: false,  //禁用原生搜索
            orderMulti: false,  //启用多列排序
            order: [],  //取消默认排序查询,否则复选框一列会出现小箭头
            renderer: "bootstrap",  //渲染样式：Bootstrap和jquery-ui
            pagingType: "simple_numbers",  //分页样式：simple,simple_numbers,full,full_numbers
            columnDefs: [{
                "targets": 'nosort',  //列的样式名
                "orderable": false    //包含上样式名‘nosort’的禁止排序
            }],
            ajax: function (data, callback, settings) {
                //封装请求参数
                var param = {};
                param.rows = data.length;//页面显示记录条数，在页面显示每页显示多少项的时候
                param.page = (data.start / data.length)+1;//当前页码
                //console.log(param);
                //ajax请求数据
                $.ajax({
                    type: "GET",
                    url: "/api/product",
                    cache: false,  //禁用缓存
                    data: param,  //传入组装的参数
                    dataType: "json",
                    success: function (result) {
                        //console.log(result);
                        //封装返回数据
                        var returnData = {};
                        returnData.draw = data.draw;//这里直接自行返回了draw计数器,应该由后台返回
                        returnData.recordsTotal = result.pageInfo.total;//返回数据全部记录
                        returnData.recordsFiltered = result.pageInfo.total;//后台不实现过滤功能，每次查询均视作全部结果
                        returnData.data = result.pageInfo.list;//返回的数据列表
                        //console.log(returnData);
                        //调用DataTables提供的callback方法，代表数据已封装完成并传回DataTables进行渲染
                        //此时的数据需确保正确无误，异常判断应在执行此回调前自行处理完毕
                        callback(returnData);
                    }
                });
            },
            //列表表头字段
            columns: [
                { "data": "id" },
                { "data": "dataTypeProps" },
                { "data": "dataType" },
                { "data": "designation" },
                { "data": "userId" },
                { "data": "addTime" },
                { "data": "addTime" }
            ]
        }).api();
        //此处需调用api()方法,否则返回的是JQuery对象而不是DataTables的API对象
    });
</script>
</body>
</html>